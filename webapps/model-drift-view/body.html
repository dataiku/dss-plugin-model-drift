<link rel="stylesheet" href="/plugins/model-drift/resource/style.css" />
<script src="/plugins/model-drift/resource/dku-helpers.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="https://d3js.org/d3.v4.js"></script>


<div class="view-content" style="margin: 8px;">

<div style="width: 1000px">
    Model drift detection gives you insight on the applicability of a model.
    Provide a dataset on which you want to know if you can confidently apply this model.
    Model drift detection will then compare it to the data on which the model was initially evaluated.
    If the dataset you provide is "similar" enough to the initial evaluation data, it gives you additional trust the applicability of your model.

    <div style="margin-top: 8px">
        <a href="https://www.dataiku.com/community/plugins/info/model-drift.html">Plugin documentation <i class="icon-external-link"></i></a>.
    </div>
</div>
<div style="margin: 16px 0;">
    Input dataset
    <select id="dataset-selector" style="width: 200px; margin: 0 8px;"></select>
    <a class="btn btn-primary" id="run-button" type="button">Run</a>
</div>

<div id="error_message" style="width: 1000px; box-sizing: border-box; padding: 0;"></div>

<div id="info-panel" style="display: none;">
    <div class="white-box">
        <div class="explanation" style="float: right; width: calc(100% - 250px);">
            <b>Lower is better</b> This score between 0 and 1 measures the discrepancy between the test dataset used to orginally evaluate the model and your input dataset. See the documentation for details.
        </div>
        <h2>Drift Score</h2>
        <div id="drift-score"></div>
    </div>

    <div class="white-box">
        <h2>Model Information</h2>

        <div style="margin-bottom: 24px">
            <div class="explanation" style="float: right; width: calc(100% - 500px);">
                Fugacity expresses the difference between expected and observed samples. We compare the proportion of samples predicted in each class when applying the model on both the original test and your input datasets.
            </div>
            <h4>Fugacity</h4>
            <div id="fugacity-score"></div>
        </div>

        <div>
            <div class="explanation" style="float: right; width: calc(100% - 500px);">
                The density chart illustrates how the original test dataset predicted probability distribution differs from that of the selected dataset. The density functions show the probability density of predicted rows in the test dataset (as positive) vs predicted rows in the selected dataset (as positive). A highly drifted model fully separates the density functions. <br> <br> The t-test aims at determining whether there is a significant difference between the mean of the two probability predicted distributions on the test dataset and on the selected dataset. Usually a p-value smaller than 0.005 means that the null hypothesis (the two populations have identical average values) is rejected. Here the p-value is
                <span id="t-test-result"></span>
            </div>
            <h4>
                Density chart
                <select id="label-list"></select>
            </h4>
            <div id="kde-chart"></div>
        </div>
    </div>

    <div class="white-box">
        <div class="explanation" style="float: right; width: calc(100% - 500px);">
            The scatter plot shows how important each features used in the model are in the drift detection model. On the x-axis is the drift feature importance ranking, i.e. the feature importance in the drift detection model. The closer the point is to the left, the more the feature was important in the drift model. On the y-axis is the original feature importance ranking.<br><br> Features that are in the red zone are those that need to be carefully examined as they are both important in the original and the drift models.
        </div>
        <h2>Feature Drift Overview</h2>
        <div id="feat-imp-plot"></div>
    </div>
</div>

</div>
